# Домашняя лаборатория по кибербезопасности — VMware + pfSense + Security Onion

> Полностью изолированная, сегментированная домашняя лаборатория для отработки навыков наступательной безопасности, сетевой защиты и обнаружения угроз с помощью SIEM.

---

## Описание проекта

Данный проект представляет собой виртуализированную лабораторию по кибербезопасности, развёрнутую в **VMware Workstation**. Цель — симуляция реалистичной корпоративной сетевой среды с сегментацией на VLAN-ы, stateful-файрволом, машинами атакующего и целей, а также стеком мониторинга безопасности.

Лаборатория предоставляет безопасную контролируемую среду для:
- Отработки техник пентестинга
- Анализа сетевого трафика и поведения атакующих
- Изучения возможностей SIEM на реальных данных атак
- Понимания проектирования правил файрвола и маршрутизации между VLAN-ами

---

## Архитектура

![Архитектура сети](screenshots/Schema.png)

---

## Виртуальные машины

| Машина | ОС | Роль | Сеть |
|---|---|---|---|
| pfSense VM | pfSense CE | Файрвол / Маршрутизатор | Все VLAN-ы |
| Kali Linux VM | Kali Linux | Атакующий | ATTACKVLAN — 192.168.30.0/24 |
| Windows Target VM | Windows | Цель | TARGETVLAN — 192.168.10.0/24 |
| Ubuntu Target VM | Ubuntu | Цель | TARGETVLAN — 192.168.10.0/24 |
| Ubuntu Analyst VM | Ubuntu | Рабочее место аналитика | SECURITYMGMTVLAN — 192.168.20.0/24 |
| Security Onion VM | Security Onion | IDS / SIEM | SECURITYMGMTVLAN — 192.168.20.0/24 |

---

## Сегментация VLAN

Сеть разделена на три изолированных VLAN-а, управляемых правилами pfSense:

| VLAN | Подсеть | Назначение |
|---|---|---|
| ATTACKVLAN | 192.168.30.0/24 | Наступательные операции (Kali Linux) |
| TARGETVLAN | 192.168.10.0/24 | Уязвимые целевые машины |
| SECURITYMGMTVLAN | 192.168.20.0/24 | Мониторинг, анализ, SIEM |

---

## Правила файрвола

### WAN-интерфейс

![Правила WAN](screenshots/WANInterface.png)

Одно разрешающее правило для IPv4 — обеспечивает выход хост-машины в интернет через pfSense.

---

### ATTACKVLAN

![Правила ATTACKVLAN](screenshots/Attack.png)

VLAN атакующего заблокирован от доступа к сегменту управления безопасностью, чтобы исключить вмешательство в инструменты мониторинга. Трафик в сторону TARGETVLAN разрешён для проведения атак.

---

### TARGETVLAN

![Правила TARGETVLAN](screenshots/Target.png)

Целевые машины имеют ограниченную связь с сегментом управления безопасностью (ICMP, DNS) в целях мониторинга, при этом общий доступ к нему заблокирован. Исходящий интернет-трафик разрешён на стандартных портах (80, 443, 53).

---

### SECURITYMGMTVLAN

![Правила SECURITYMGMTVLAN](screenshots/Sec.png)

Сегмент управления безопасностью имеет широкий исходящий доступ для обновления инструментов, получения threat intelligence и работы аналитиков. Правило Anti-Lockout гарантирует постоянный административный доступ к pfSense.

---

## Стек мониторинга безопасности

**Security Onion** развёрнут как основная платформа обнаружения угроз и анализа, включающая:

- **Suricata** — Сетевой IDS/IPS с сигнатурным обнаружением
- **Zeek (Bro)** — Глубокий анализ сетевого трафика и логирование
- **Elasticsearch** — Приём, индексирование и хранение логов
- **Kibana** — Дашборды и визуализация событий безопасности
- **SOC-аналитика** — Triage алертов, просмотр PCAP, корреляция событий

Трафик из TARGETVLAN анализировался Security Onion, что обеспечивало обнаружение атак в реальном времени.

---

## Продемонстрированные навыки

- **Проектирование сетей** — Сегментация VLAN, подсети, маршрутизация между VLAN-ами
- **Администрирование файрвола** — Создание stateful-правил и политик трафика в pfSense
- **Наступательная безопасность** — Контролируемые атаки с Kali Linux
- **Обнаружение угроз** — Настройка сигнатур IDS, анализ алертов в Security Onion
- **Работа с SIEM** — Анализ логов, создание дашбордов, корреляция событий в Elasticsearch/Kibana
- **Виртуализация** — Развёртывание нескольких VM и настройка сетей в VMware Workstation

---

## Используемые технологии

`VMware Workstation` `pfSense CE` `Kali Linux` `Security Onion` `Suricata` `Zeek` `Elasticsearch` `Kibana` `Ubuntu` `Windows`

---

## Структура репозитория

```
home-security-lab/
 ├── screenshots/
 │   ├── Schema.png
 │   ├── Attack.png
 │   ├── Target.png
 │   ├── Sec.png
 │   └── WAN_Interface.png
 ├── README.md
 └── README_RU.md
```

---

*Проект создан в образовательных целях. Все атаки проводились исключительно внутри изолированной лабораторной среды.*
